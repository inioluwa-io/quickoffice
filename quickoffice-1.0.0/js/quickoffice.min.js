/*
 VERSION: 1.0.0
 DATE: 2019-5-31

 @license Copyright (c) 2019, Quickoffice. All rights reserved.

 @author: Inioluwa Sogelola, inioluwwa4.is@gmail.com
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,c,e){$jscomp.initSymbolIterator();c=null!=c?c:function(a){return a};var b=[],f=a[Symbol.iterator];if("function"==typeof f)for(a=f.call(a);!(f=a.next()).done;)b.push(c.call(e,f.value));else{f=a.length;for(var g=0;g<f;g++)b.push(c.call(e,a[g]))}return b}},"es6","es3");$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof d?a:new d(function(b,g){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){e(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(k){this.asyncThrow_(k)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var d=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};d.prototype.createResolveAndReject_=
function(){function a(a){return function(g){c||(c=!0,a.call(b,g))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};d.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof d)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};d.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new b;d.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};d.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(k){c.reject(k)}};d.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{k(a(b))}catch(n){e(n)}}:b}var k,e,g=new d(function(a,
b){k=a;e=b});this.callWhenSettled_(c(a,k),c(b,e));return g};d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};d.resolve=c;d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,
d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,d)})};d.all=function(a){var b=$jscomp.makeIterator(a),e=b.next();return e.done?c([]):new d(function(a,d){function f(b){return function(c){k[b]=c;m--;0==m&&a(k)}}var k=[],m=0;do k.push(void 0),m++,c(e.value).callWhenSettled_(f(k.length-1),d),e=b.next();while(!e.done)})};return d},"es6","es3");var Quickoffice=function(){},mydata=[],images=[],saving,saved,title=[],$=$,doc=this.document,p=Quickoffice.prototype;
p.constructor=Quickoffice;Quickoffice.version="1.0.0";
p.controller=function(a){a=a=$(a);if("undefined"!=typeof $)if(0<a.length)nextInput(a,"Title goes here","text"),a.focusin(function(b){var c=Array.from(b.target.parentNode.parentNode.children).indexOf(b.target.parentNode);"undefined"==typeof $(b.target.parentElement).next().val()&&nextInput(a,"Content","text",c,b)}),a.keyup(function(b){if(1<=b.target.parentElement.querySelector("textarea").value.length){if(b.keyCode){var c=Array.from(b.target.parentNode.parentNode.children).indexOf(b.target.parentNode);0==
c?saveChanges(title,c,("<h1>"+b.target.value.toString()+"</h1>").replace(/(?:\r\n|\r|\n)/g,"<br>"),1):"video-embedded"!==b.target.id?saveChanges(mydata,c,("<p>"+b.target.value.toString()+"</p>").replace(/(?:\r\n|\r|\n)/g,"<br>"),1):saveChanges(mydata,c,b.target.value.toString().replace(/(?:\r\n|\r|\n)/g,"<br>"),1);"undefined"==typeof $(b.target.parentElement).next().val()&&nextInput(a,"Content","text",c,b)}}else 1>b.target.value.length&&(c=Array.from(b.target.parentNode.parentNode.children).indexOf(b.target.parentElement),
0==c?saveChanges(title,c,("<h1>"+b.target.value.toString()+"</h1>").replace(/(?:\r\n|\r|\n)/g,"<br>"),1):(b=mydata.length,mydata.splice(c-1,1,""),saveChanges(mydata,c,"",1),saveChanges(mydata,b,null,0)))});else throw new ReferenceError("HTML element not found");else throw new ReferenceError("jQuery is required");};p.fetchInputData=function(){for(var a=title[0],b=mydata.join(" ").toString(),c=new FormData,e=0;e<images.length;e++)c.append("image[]",images[e]);return{title:a,content:b,getImagePath:c}};
p.fetch=function(a,b,c){return new Promise(function(e,d){jQuery.ajax({type:b,url:a,data:c,contentType:!1,processData:!1,cache:!1,success:function(a){return e(a)},error:function(a,c,d){if("Not Found"==d)throw new ReferenceError("could not "+b.toLowerCase()+" data. ");}})})};p.getImages=function(){};
function nextInput(a,b,c,e,d){var f=0,g=doc.createElement("textarea");d=doc.createElement("div");d.classList="outerdiv";var l=doc.createAttribute("type");l.value=c;g.setAttributeNode(l);g.placeholder=b;g.classList="inputfield";d.append(g)||d.appendChild(g);a.append(d)||a.append(d);if("Content"==b&&(f++,0<f)){b=doc.createElement("input");c=doc.createAttribute("type");f=doc.createAttribute("name");g=doc.createAttribute("accept");c.value="file";f.value="image"+e;g.value="image/x-png,image/gif,image/jpeg";
b.setAttributeNode(g);b.setAttributeNode(c);b.setAttributeNode(f);b.classList="inputfield cam";d.append(b)||d.appendChild(b);d.append(init_button(a,e));d.append(init_closebutton(a));var h=doc.createElement("img");d.append(h);a={};for(d=0;d<$(".more-btn").length;a={clicked:a.clicked},d++)a.clicked=!1,$(".more-btn")[d].addEventListener("click",function(a){return function(b){var c=b.target.parentElement.querySelector(".options");if(a.clicked)$(c.parentElement.parentElement).removeClass("embedded"),$(c.parentElement.parentElement).removeClass("clicked"),
$(c).removeClass("active"),c.parentElement.parentElement.querySelector("textarea").style.display="block",c.parentElement.parentElement.querySelector("textarea").id="",c.parentElement.parentElement.querySelector("textarea").value="",mydata.splice(Array.from(b.target.parentNode.parentNode.parentNode.children).indexOf(b.target.parentNode.parentNode)-1,1,""),c.parentElement.parentElement.querySelector("textarea").placeholder="Content",c.parentElement.parentElement.querySelector("input").style.display=
"none",c.parentElement.parentElement.querySelector("input").style.visibility="hidden";else{$(b.target.parentElement.parentElement).addClass("clicked");$(c).addClass("active");var d=b.target.parentElement.querySelector(".camera");b=b.target.parentElement.querySelector(".play");d.querySelector(".fa").addEventListener("click",function(b){b.target.parentElement.parentElement.parentElement.parentElement.querySelector("input").id=Array.from(b.target.parentNode.parentNode.parentNode.parentNode.parentNode.children).indexOf(b.target.parentElement.parentNode.parentNode.parentNode);
b.target.parentElement.parentElement.parentElement.parentElement.querySelector("textarea").style.display="none";b.target.parentElement.parentElement.parentElement.parentElement.querySelector("input").style.display="block";b.target.parentElement.parentElement.parentElement.parentElement.querySelector("input").style.visibility="visible";b.target.parentElement.parentElement.parentElement.parentElement.querySelector("textarea").value="";getImage(mydata,e,b.target.parentElement.parentElement.parentElement.parentElement.querySelector("input"));
"undefined"!==typeof b.target.parentElement.parentElement.parentElement.parentElement.querySelector("input").files[0]&&(h.src=b.target.parentElement.parentElement.parentElement.parentElement.querySelector("input").files[0].name,a.clicked=!a.clicked);$(c.parentElement.parentElement).removeClass("embedded");$(c.parentElement.parentElement).removeClass("clicked");$(c).removeClass("active")});b.querySelector(".fa").addEventListener("click",function(a){$(a.target.parentElement.parentElement.parentElement.parentElement.parentElement).removeClass("clicked");
$(c).removeClass("active");a.target.parentElement.parentElement.parentElement.parentElement.querySelector("textarea").style.display="block";a.target.parentElement.parentElement.parentElement.parentElement.querySelector("textarea").value="";a.target.parentElement.parentElement.parentElement.parentElement.querySelector("textarea").id="video-embedded";a.target.parentElement.parentElement.parentElement.parentElement.querySelector("textarea").placeholder="Paste a YouTube, Vine or other video link";$(a.target.parentElement.parentElement.parentElement.parentElement).addClass("embedded");
"undefined"!==typeof a.target.parentElement.parentElement.parentElement.parentElement.querySelector("input").files[0]&&(h.src=a.target.parentElement.parentElement.parentElement.parentElement.querySelector("input").files[0].name,a.target.parentElement.parentElement.parentElement.parentElement.append(h))})}a.clicked=!a.clicked}}(a));for(a=0;a<$(".close-btn").length;a++)$(".close-btn")[a].addEventListener("click",function(a){if("undefined"!==typeof $(a.target.parentElement).prev()[0]){var b=Array.from(a.target.parentNode.parentNode.children).indexOf(a.target.parentElement);
$(a.target.parentElement).prev()[0].querySelector("textarea").getAttribute("placeholder");for(var c=$(a.target.parentElement.parentElement)[0].querySelectorAll(".outerdiv"),d=c.length,e=1;e<d;e++)$(a.target.parentElement).next()[0]&&1<e&&(c[e].querySelector("input").setAttribute("id",e-1),c[e].querySelector(".camera").setAttribute("for",e-1),c[e].querySelector(".camera").setAttribute("for",e-1),c[e].querySelector(".play").setAttribute("for",e-1));$(a.target.parentElement).prev()[0].querySelector("textarea").focus();
"undefined"!=typeof a.target.parentElement.querySelector("input").files[0]&&_deleteImages(a.target.parentElement.querySelector("input").files[0]);a.target.parentElement.parentElement.removeChild(a.target.parentElement);mydata.splice(b-1,1)}})}}function htmlspecialchars(a){if("string"==typeof a)return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");throw new TypeError("htmlspecialchars expects a string, "+typeof a+" given.");}
function init_button(a,b){var c=[["camera","fa fa-camera"],["play","fa fa-play"]];a[0].querySelector(".outerdiv");a=doc.createElement("div");var e=doc.createElement("div"),d=doc.createElement("div");d.classList="more-container";a.classList="more-btn";e.classList="options";for(var f=0;f<c.length;f++){var g=doc.createElement("i"),l=doc.createAttribute("for");l.value=b+1;var h=doc.createElement("label");h.setAttributeNode(l);h.classList=c[f][0];g.classList=c[f][1];h.append(g);e.append(h)}d.append(a);
d.append(e);return d}function init_closebutton(a){a[0].querySelector(".outerdiv");a=doc.createElement("div");a.classList="close-btn";return a}function init_inputValue(a){return a}function saveChanges(a,b,c,e){(new Promise(function(d,f){a.splice(b-e,1,c);d("Saved");saving="saving..."})).then(function(a){saved=a})}function getImage(a,b,c){$(c).change(function(b){b=$(c)[0].getAttribute("id");saveChanges(a,b,"<img src = '"+c.files[0].name.toString()+"'/>",1);_getImages(c.files[0])})}
function _getImages(a){for(var b=0,c=0;c<mydata.length;c++)1>mydata[c].toString().split("<img src =",1).join(" ").length&&(1>mydata[c].toString().split("<img src = '"+a.name.toString()+"'/>",1).join(" ").length&&images.splice(b,1,a),b++)}function _deleteImages(a){for(var b=0,c=0;c<mydata.length;c++)1>mydata[c].toString().split("<img src =",1).join(" ").length&&(mydata[c].toString()=="<img src = '"+a.name.toString()+"'/>"&&images.splice(b,1),b++)};
